/*! reidchoclates 31-10-2014 */

var Utils=Utils||{};Utils.isAndroid2=function(){var a=navigator.userAgent.toLowerCase();return a.indexOf("android 2")>-1?!0:!1},Utils.isBlackBerry=function(){var a=navigator.userAgent.toLowerCase();return a.indexOf("blackberry")>-1?!0:!1},Utils.isWindowsPhone=function(){return navigator.userAgent.match(/(windows phone)/i)?!0:!1},Utils.isiOS=function(){return navigator.userAgent.match(/(iPad|iPhone|iPod)/i)?!0:!1},Utils.canPlayh264=function(){var a=document.createElement("video");return a.canPlayType&&a.canPlayType("video/mp4").replace(/no/,"")?!0:!1},Utils.hexToRBG=function(a){var b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return console.log("yup!"),b?{r:parseInt(b[1],16),g:parseInt(b[2],16),b:parseInt(b[3],16)}:null},Utils.isTouch=function(){return"ontouchstart"in window},Utils.pixelDensity=function(){var a=1;return void 0!==window.devicePixelRatio&&(a=window.devicePixelRatio),a},Utils.hasHistoryAPI=function(){return!(!window.history||!history.pushState)},Utils.validEmail=function(a){var b=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return b.test(a)};var App=App||{};App.Main=function(a,b,c,d){"use strict";function e(){this.navController={},c("document").ready(c.proxy(this.handleAppReady,this)),this.alertFallback=!1,("undefined"==typeof console||"undefined"==typeof console.log)&&(console={},console.log=this.alertFallback?function(a){alert(a)}:function(){})}return e.prototype={handleAppReady:function(){this.navController=new d.NavController,"ontouchstart"in b&&c("body").removeClass("no-touch")}},e}(window,document,jQuery,App,Utils),App.Column=function(a){function b(b){this.API=new App.API,this.at=new App.ActionTree,this.HTMLFactory=new App.HTMLFactory,this.index=b.index,this.element=null,this.active=!1,this.params=a.extend({},b.params),this.action=b.action,this.subaction=b.subaction,this.columnActions=b.columnActions,this.path=b.path,this.optionsOpen=!1,this.colName="#Column",this.width=340,this.childOptions=this.at.getActions(this.path),this.nodeName=b.nodeName,this.minTime=b.minTime,this.maxTime=b.maxTime,this.page=1,this.scrollPos=0,this.account=b.account,this.setupColumn(),this.API.getData(this.account,this.action,this.params,a.proxy(this.receivedData,this))}return b.prototype={setupColumn:function(){this.element=a("#template").clone(),a(this.element).hide(),a(this.element).attr("id","Column"+this.index),a(".columnContainer").append(this.element),this.colName=this.colName+this.index;var b=a(this.colName+" .results");b.empty(),a(this.colName+" .loader").hide(),a(this.colName+" .showMore").hide(),a(this.colName+" .searchFilter").on("change",a.proxy(this.searchFilter,this)),a(this.colName+" .showMore").on("click",a.proxy(this.getMoreRows,this)),"emails/meta"===this.action?a(this.colName+" .searchFilter").hide():a(this.colName+" .emailTitle").hide(),this.setColumnActions(),this.setFilterOptions(),0===this.index?a(this.colName+" a.closeButton").hide():a(this.colName+" a.closeButton").on("click",a.proxy(this.handleColumnClose,this))},handleColumnClose:function(){a(this).trigger("Closing",[this.index])},setColumnActions:function(){a(this.colName+" .searchFilter").empty();for(var b=0;b<this.columnActions.length;b++){var c=this.columnActions[b].split("-"),d="";0===b&&(d=" selected"),"contacts-right"==this.columnActions[b]&&(c[0]="Observers");var e='<option value="'+this.columnActions[b]+'" '+d+">"+c[0]+"</option>";a(this.colName+" .searchFilter").append(e)}},searchFilter:function(){delete this.params.page,this.page=1,this.setFilterOptions(),this.searchColumn()},setFilterOptions:function(){this.nodeName=a(this.colName+" .searchFilter").val();var b,c=this.nodeName.split("-"),d=c[0];a(this.colName+" .additionalOptions a").off("click"),"contacts"===d?(b=a("#template .searchOptionWidgets .contacts").clone(),a(this.colName+" .additionalOptions").empty(),a(this.colName+" .additionalOptions").append(b),a(this.colName+" .keyword").on("focus",a.proxy(this.searchFocus,this)),a(this.colName+" .keyword").on("blur",a.proxy(this.searchBlur,this)),this.params.rel&&a(this.colName+" .additionalOptions .relationship").remove()):"emails"===d?(b=a("#template .searchOptionWidgets .emails").clone(),a(this.colName+" .additionalOptions").empty(),a(this.colName+" .additionalOptions").append(b),a(this.colName+" .keyword").on("focus",a.proxy(this.searchFocus,this)),a(this.colName+" .keyword").on("blur",a.proxy(this.searchBlur,this))):"dates"===d?(console.log(c),c[1]&&"day"==c[1]?(a(this.colName+" .additionalOptions").empty(),a(this.colName+" .start_date_year").off("change")):(b=a("#template .searchOptionWidgets .dates").clone(),a(this.colName+" .additionalOptions").empty(),a(this.colName+" .additionalOptions").append(b),a(this.colName+" .start_date_year").on("change",a.proxy(this.searchColumn,this)))):"cliques"===d?a(this.colName+" .additionalOptions").empty():"observers"===d&&a(this.colName+" .additionalOptions").empty(),a(this.colName+" .additionalOptions a").on("click",a.proxy(this.searchColumn,this))},searchColumn:function(){console.log("SEARCHING!",this.action,this.params),1==this.page&&(a(this.colName+" .loader").fadeIn(),a(this.colName+" .showMore").hide());var b=a.extend({},this.params);this.nodeName=a(this.colName+" .searchFilter").val();var c=this.nodeName.split("-");this.action!==this.nodeName&&(this.action=c[0]);var d="";if("contacts"==this.action)d=a(this.colName+" .additionalOptions .keyword").val(),""!==d&&"enter keyword"!==d?b.keyword=d:delete b.keyword,c[1],b.rel?a(this.colName+" .additionalOptions select.relationship").val()&&b.rel!=a(this.colName+" .additionalOptions select.relationship").val()&&(b.rel=a(this.colName+" .additionalOptions select.relationship").val()):b.rel=a(this.colName+" .additionalOptions select.relationship").val(),b.count&&delete b.count,b.start||delete b.end,"any"==b.rel&&delete b.rel,b.order="desc";else if("emails"==this.action)d=a(this.colName+" .additionalOptions .keyword").val(),""!==d&&"enter keyword"!==d&&d!==this.params.keyword?b.keyword=d:delete b.keyword,b.order="asc";else if("dates"==this.action)if("to"===c[1]&&c.pop(),c[1])b.order="asc",b.start=this.params.start,b.end=this.params.end,b.count=c[1];else{var e=a(this.colName+" .start_date_year").val();""!==e?(sd=new Date(e,0,1,0,0,0,0),b.year=e):delete b.year,b.count="MONTH"}else"observers"==this.action;a.isEmptyObject(b)||(b.limit=20,b.start||(b.start=this.params.start,b.start||delete b.end),this.page>1&&(b.page=this.page),this.updateAll(this.action,b),a(this).trigger("RefreshingData",[this.index,this.nodeName]),this.path[this.index+1]=this.nodeName,this.childOptions=this.at.getActions(this.path))},searchFocus:function(){var b=a(this.colName+" .keyword");b.removeClass("error"),"enter keyword"===b.val()&&b.val("")},searchBlur:function(){var b=a(this.colName+" .keyword");""===b.val()?b.val("enter keyword"):b.removeClass("error")},receivedData:function(b){var c=a(this.colName+" .results"),d={};a(this).trigger("DataReceived",[this.index]),"contacts"==this.action?d=b.contacts.contact:"dates"==this.action?d=b.dates.dates:"emails"==this.action?d=b.emails.email:"emails/meta"==this.action?d=b.emails.email:"cliques"==this.action?d=b:"observers"==this.action&&(d=b),1==this.page&&a(c).hide(),0===d.length&&1==this.page?c.append(this.HTMLFactory.generateNoResults()):"emails/meta"==this.action?this.renderEmails(d):this.renderRows(d),1==this.page&&a(c).fadeIn(),this.active?a(this).trigger("Updated"):(this.active=!0,a(this).trigger("Ready")),a(this.colName+" .loader").fadeOut(),a(this.colName+" .scrollContainer").scrollTop(this.scrollPos)},renderEmails:function(b){var c=a(this.colName+" .results");c.append(this.HTMLFactory.generateEmail(b,this.params)),a(this.colName).addClass("wider")},renderRows:function(b){for(var c=a(this.colName+" .results"),d=0,e=0;e<b.length;e++)c.append(this.HTMLFactory.generateRow(this.action,this.params,b[e]));var f=c.children(".resultContainer");for(e=0;e<f.length;e++){var g=parseInt(a(f[e]).children(".tally").text());g>d&&(d=g)}var h=0;for(e=0;e<f.length;e++){var i=parseInt(a(f[e]).children(".tally").text()),j=c.children(".resultContainer").eq(e).children(".bar"),k=a(this.element).width()-2*parseInt(a(j).css("left")),l=Math.round(i/d*k);a(j).css("width",l),a(f[e]).hasClass("on")&&(h=e),"emails"==this.action&&a(j).css("width",k)}h&&(c.children(".resultContainer").addClass("dim"),c.children(".resultContainer").eq(h).removeClass("dim")),count=0,a(this.colName+" .resultContainer").each(a.proxy(function(b,c){a(c).on("click",a.proxy(this.newColumnRequest,this,[count])),count++},this)),20==b.length?a(this.colName+" .showMore").fadeIn():a(this.colName+" .showMore").hide()},newColumnRequest:function(b){a(this.colName+" .resultContainer").removeClass("on");var c=a(this.colName+" .resultContainer").eq(b),d=c.children("input").val(),e=this.childOptions[0].split("-"),f="",g="",h=a(this.colName+" .additionalOptions select.relationship").val();f=e[0],e.length>1&&(g=e[1]);var i=a.extend({},this.params);if(delete i.keyword,delete i.count,delete i.page,delete i.order,"contacts"===f)"dates"==this.action?(i.start=d.split("-")[0],i.end=d.split("-")[1]):(i[g]=d,i.count="to",i.rel||(i.rel=h));else if("dates"===f){if("dates"==this.action){var j=new Date;j.setTime(1e3*d.split("-")[0]),i.year=j.getFullYear(),i.month=j.getMonth()+1}else"contacts"==this.action&&(this.params.left&&this.params.right?i.observer=d:this.params.left&&(i.right=d));i.count="month","day"==g&&(i.order="asc",i.count="day",g="")}else"emails"===f?(i.order="asc","dates"==this.action?(i.start=d.split("-")[0],i.end=d.split("-")[1]):"contacts"==this.action?this.params.left&&this.params.right?i.observer=d:this.params.left?i.right=d:i.left=d:"emails"==this.action&&(i.id=d)):"emails/meta"===f?(i.id=d,delete i.limit):"observers"==this.action;console.log(this.index,"P-A:",i,f),a(this.colName+" .resultContainer").addClass("dim"),c.removeClass("dim"),c.addClass("on"),c.children(".loading").fadeIn(100),a(this).trigger("NewColumn",[this.index,f,i,b])},getMoreRows:function(){a(this.colName+" .resultContainer").each(a.proxy(function(b,c){a(c).off("click")},this)),this.page++,this.searchColumn(),this.scrollPos=a(this.colName+" .scrollContainer").scrollTop()},removeHighlight:function(){a(this.colName+" .resultContainer").removeClass("dim"),a(this.colName+" .resultContainer").removeClass("on")},updateAll:function(b,c){this.action=b,this.params=a.extend({},c),this.params.page||this.clearData(),"emails/meta"==b&&this.clearData(),this.API.getData(this.account,this.action,this.params,a.proxy(this.receivedData,this))},clearData:function(){a(this.colName+" .noresults").remove(),a(this.colName+" .resultContainer").remove(),a(this.colName+" .emailContainer").remove()},destroy:function(){a(this.element).remove()}},b}(jQuery,document,window,Utils),App.ColumnController=function(a,b,c){function d(b){this.columns=[],this.activeColumn=-1,this.activeRow=-1,this.totalColWidth=0,this.path=["root"],this.at=new App.ActionTree,this.dateSettings={},this.account=b,a(c).resize(a.proxy(this.handleResize,this)),this.adjustColumnHeight(),a("#loader").fadeIn()}return d.prototype={setDates:function(b){this.dateSettings=b;var c=new Date(b.minTime),d=new Date(b.maxTime);a(".optionContainer.dates .year").empty(),a(".optionContainer.dates .year").append('<option value="">all</option>');for(var e=c.getFullYear();e<=d.getFullYear();e++)a(".optionContainer.dates .year").append('<option value="'+e+'">'+e+"</option>")},addColumn:function(b,c){var d=this.at.getActions(this.path);this.path.push(d[0]);var e=new App.Column({action:b,params:c,index:this.columns.length,path:this.path.slice(0),columnActions:d,nodeName:d[0],maxTime:this.dateSettings.maxTime,minTime:this.dateSettings.minTime,account:this.account});a(e).on("Ready",a.proxy(this.displayColumn,this,[this.columns.length])),a(e).on("Updated",a.proxy(this.updatedColumn,this)),a(e).on("NewColumn",a.proxy(this.newColumnRequest,this)),a(e).on("Closing",a.proxy(this.closingColumn,this)),a(e).on("DataReceived",a.proxy(this.columnDataRecieved,this)),a(e).on("RefreshingData",a.proxy(this.updatePath,this)),this.columns.push(e)},updatedColumn:function(){this.adjustColumnHeight()},updatePath:function(a,b,c){c!=this.path[b+1]&&(this.path[b+1]=c,this.columns.length>b&&this.removeColumns(b+1))},columnDataRecieved:function(b,c){c>0&&(a("#Column"+(c-1)+" .loading").hide(),a("#Column"+(c-1)+" .resultContainer").eq(this.activeRow).children(".arrow").fadeIn())},newColumnRequest:function(b,c,d,e,f){this.columns[c+1]?(this.columns.length>c+1&&(this.removeColumns(c+2),console.log("NEWCOL",c,d,e),this.path[c+2]!=d&&(d=this.columns[c+1].action,e.count=this.columns[c+1].params.count,this.columns[c+1].params.start&&!e.start&&(e.start=this.columns[c+1].params.start),this.columns[c+1].params.end&&!e.end&&(e.end=this.columns[c+1].params.end))),a(this.columns[c+1].colName+" .loader").fadeIn(),this.columns[c+1].updateAll(d,e)):this.addColumn(d,e),this.activeRow=f},displayColumn:function(b){var d=b[0];this.columns.length>0&&a("#loader").fadeOut();var e=this.columns[d].element,f=d*this.columns[d].width;this.totalColWidth+=this.columns[d].width,a(e).css("left",f-80),a(e).hide().fadeIn(300,a.proxy(function(){if(this.totalColWidth>a(c).width()){var b=this.totalColWidth-a(c).width();a(".columnContainer").animate({scrollLeft:b},300)}},this)),a(e).css("left",f),this.adjustColumnHeight(),this.activeColumn=d},removeColumns:function(a){if(this.columns.length>a)for(var b=100*(this.columns.length-a),c=this.columns.length-1;c>=a;c--)this.removeColumn(c,b-100*c),this.path.pop();a-1>=0&&this.columns[a-1].removeHighlight()},removeColumn:function(b,c){a(this.columns[b].element).delay(c).fadeOut(300,a.proxy(function(){this.columns[b].destroy(),this.columns.splice(b,1)},this))},closingColumn:function(a,b){this.removeColumns(b)},adjustColumnHeight:function(){var b=0,d=0;b=a(c).height()-a("header").outerHeight(),a(".columnContainer").css("height",b);var e=a(".column");a(".column").css("height","");for(var f=0;f<e.length;f++){a(e[f]).height()>d&&(d=a(e[f]).height());var g=b-a(e[f]).children(".colHeader").height()-2*parseInt(a(e[f]).children(".colHeader").css("padding-left"));a(e[f]).children(".scrollContainer").css("height",g)}b>d&&(d=b),a(".column").css("height",b)},handleResize:function(){this.adjustColumnHeight()},destroy:function(){this.removeColumns(0)}},d}(jQuery,document,window,Utils),App.HTMLFactory=function(a){function b(){console.log("HTML FACTORY INIT")}var c=[31,28,31,30,31,30,31,31,30,31,30,31],d=["January","February","March","April","May","June","July","August","September","October","November","December"];return b.prototype={generateNoResults:function(){return noResults=a("#template .noresults").eq(0).clone()},generateColumn:function(){},generateRow:function(b,e,f){newRow=a("#template .resultContainer").eq(0).clone();a(newRow).children(".bar");if(a(newRow).children(".tally").text(f.count),"contacts"==b)a(newRow).find(".title span").text(f.name),a(newRow).find(".title i").addClass("fa-user"),a(newRow).children("input").val(f.email);else if("dates"==b){var g,h;"MONTH"===e.count.toUpperCase()?(g=new Date(f.year,f.month-1,1,0,0,0,0),h=new Date(f.year,f.month-1,c[f.month-1],23,59,59,0),a(newRow).find(".title>span").text(d[f.month-1]+", "+f.year)):"DAY"===e.count.toUpperCase()&&(g=new Date(f.year,f.month-1,f.day,0,0,0,0),h=new Date(f.year,f.month-1,f.day,23,59,59,999),a(newRow).find(".title>span").text(d[f.month-1]+" "+f.day+", "+f.year)),a(newRow).find(".title>i").addClass("fa-calendar"),a(newRow).children("input").val(g.getTime()/1e3+"-"+h.getTime()/1e3)}else if("emails"==b){var i=new Date;i.setTime(1e3*f.date.utc),a(newRow).find(".title>span").text(i.toLocaleTimeString()+" "+f.subject),a(newRow).children(".title").attr("title",f.subject),a(newRow).children("input").val(f.id),a(newRow).find(".title i").addClass("fa-envelope")}return newRow},generateEmail:function(b,c){newEmail=a("#template .emailContainer").eq(0).clone();var d=new Date;if(d.setTime(1e3*b.date.utc),newEmail.children(".subjectContainer").text(b.subject),newEmail.children(".date").text(b.date.date),newEmail.find(".fromContainer .name").text(b.contacts.from[0].name),newEmail.find(".fromContainer .email").text(b.contacts.from[0].email),(b.contacts.from[0].email==c.left||b.contacts.from[0].email==c.right)&&newEmail.find(".fromContainer .contact").eq(0).addClass("found"),b.contacts.to)for(var e=0;e<b.contacts.to.length;e++)newEmail.children(".toContainer").append(this.generateContact(b.contacts.to[e])),(b.contacts.to[e].email==c.left||b.contacts.to[e].email==c.right)&&newEmail.find(".toContainer .contact").eq(e).addClass("found");if(b.contacts.cc)for(var f=0;f<b.contacts.cc.length;f++)newEmail.children(".ccContainer").append(this.generateContact(b.contacts.cc[f])),console.log(b.contacts.cc[f].email,c.observer),(b.contacts.cc[f].email==c.left||b.contacts.cc[f].email==c.right||b.contacts.cc[f].email==c.observer)&&newEmail.find(".ccContainer .contact").eq(f).addClass("found");else newEmail.children(".ccContainer").hide();if(b.contacts.bcc)for(var g=0;g<b.contacts.bcc.length;g++)newEmail.children(".bccContainer").append(this.generateContact(b.contacts.bcc[g])),(b.contacts.bcc[g].email==c.left||b.contacts.bcc[g].email==c.right||b.contacts.bcc[g].email==c.observer)&&newEmail.find(".bccContainer .contact").eq(g).addClass("found");else newEmail.children(".bccContainer").hide();return newEmail},generateContact:function(b){var c=a("#template .emailContainer .contact").eq(0).clone();return"null"!==b.name?(c.children(".name").text(b.name),c.children(".email").text("<"+b.email+">")):(c.children(".name").text("<"+b.email+">"),c.children(".email").hide()),c},generateDIV:function(b,c){var d=a("<div></div>");if(b.length)for(var e=0;e<b.length;e++)d.addClass(b[e]);return d.html(c),d},destroy:function(){}},b}(jQuery,document,window,Utils),App.MinezyController=function(a,b,c,d){function e(){console.log("MINEZY INIT"),this.accounts={},this.account=void 0,this.progressTimer=0,this.tmpcount=0,a(c).on("mediaQueryChange",a.proxy(this.handleMediaQueryChange,this)),a(c).resize(a.proxy(this.handleResize,this)),d.isTouch()?a(c).on("touchmove",a.proxy(this.handleScroll,this)):a(c).scroll(a.proxy(this.handleScroll,this)),this.dateSettings={},this.API=new App.API,this.account=100,this.API.getData(0,"accounts",{},a.proxy(this.checkAccount,this)),a(".info.about .button").on("click",a.proxy(this.showInfo,this))}return e.prototype={checkAccount:function(b){for(var c=b.accounts.account,d=0;d<c.length;d++)c[d].id==a.cookie("account")&&(this.account=a.cookie("account"));this.account>0?this.loadAccount():this.showSettings()},initAccounts:function(){a("#account_id").empty();for(var b=0;b<this.accounts.length;b++){var c="";this.account==this.accounts[b].id&&(c=" selected"),a("#account_id").append('<option value="'+this.accounts[b].id+'" '+c+">"+this.accounts[b].account+"</option>")}},showInfo:function(){a(".siteOverlay").fadeIn(500),setTimeout(a.proxy(function(){console.log("here"),a("section.admin.info").removeClass("hide")},this),100),a("section.admin.info .closeButton").on("click",a.proxy(this.hideInfo,this)),a("section.admin.info .button.ok").on("click",a.proxy(this.hideInfo,this))},showSettings:function(){a(".siteOverlay").fadeIn(500),setTimeout(a.proxy(function(){console.log("here"),a("section.admin").removeClass("hide")},this),100),a("section.admin .closeButton,section.admin .button.cancel").on("click",a.proxy(this.hideSettings,this)),a("section.admin .button.ok").on("click",a.proxy(this.saveSettings,this)),a("section.admin .filename").hide(),a(":file").change(a.proxy(function(b){a(".filename").fadeIn(),a(".filename>span").text(b.currentTarget.files[0].name),a(".button.ok>i").removeClass("fa-check"),a(".button.ok>i").addClass("fa-upload"),a(".button.ok>span").text("Upload"),a("select.databases").prop("disabled","disabled"),a(".dbSelect").addClass("disabled"),a("section.admin .button.ok").off("click"),a("section.admin .button.ok").on("click",a.proxy(this.uploadFile,this))},this)),this.API.getData(0,"accounts",{},a.proxy(this.getAccounts,this))},uploadFile:function(){a("section.admin .button.ok").off("click"),a("section.admin .button.ok").addClass("disabled"),a(".button.ok>span").text("Uploading"),a(".button.ok>i").removeClass("fa-upload"),a(".button.ok>i").addClass("fa-refresh"),a(".button.ok>i").addClass("rotating"),a("section.admin .progressBar").hide(),a("section.admin .progressBar").slideDown(),a("section.admin .progressBar>.bar").width(0),a("section.admin .progressBar>span").text("0%"),console.log(a("#uploadFile").ajaxForm()),a("#uploadFile").ajaxSubmit({beforeSend:function(){var b="0%";a("section.admin .progressBar>.bar").width(b),a("section.admin .progressBar>span").html(b),console.log("BEGIN UPLOAD")},uploadProgress:function(b,c,d,e){var f=e+"%";a("section.admin .progressBar>.bar").width(f),a("section.admin .progressBar>span").html(f),console.log(e)},success:function(){var b="100%";a("section.admin .progressBar>.bar").width(b),a("section.admin .progressBar>span").html(b)},complete:a.proxy(function(b){b.responseText&&(a("section.admin .progressBar>.bar").width(0),a("section.admin .progressBar>span").text("0%"),a(".button.ok>span").text("Processing"),this.API.getData(0,"new_account",{file:b.responseText},a.proxy(this.startProcessing,this)))},this)})},startProcessing:function(b){a.cookie("account",b.account,{expires:365,path:"/"}),this.account=b.account,this.tmpcount=0,this.progressTimer=setInterval(a.proxy(function(){this.API.getData(0,"new_account/progress",{},a.proxy(this.updateProcessingProgress,this))},this),1e3)},updateProcessingProgress:function(){var b=this.tmpcount+"%";a("section.admin .progressBar>.bar").width(b),a("section.admin .progressBar>span").html(b),100==this.tmpcount&&(clearInterval(this.progressTimer),this.API.getData(0,"accounts",{},a.proxy(this.getAccounts,this)),this.hideSettings()),this.tmpcount+=10},hideInfo:function(){a("section.admin.info .closeButton,section.admin .button.cancel").off("click"),a("section.admin.info .button.ok").off("click"),a("section.admin.info").addClass("hide"),setTimeout(a.proxy(function(){a(".siteOverlay").fadeOut(500),this.resetSettings()},this),300)},hideSettings:function(){a("section.admin .closeButton,section.admin .button.cancel").off("click"),a("section.admin .button.ok").off("click"),a("section.admin").addClass("hide"),a(":file").off("change"),setTimeout(a.proxy(function(){a(".siteOverlay").fadeOut(500),this.resetSettings()},this),300)},resetSettings:function(){a("section.admin .button.ok>i").removeClass(),a("section.admin .button.ok>i").addClass("fa fa-check"),a(".button.ok>span").text("OK"),a("section.admin .progressBar").slideUp(),a("section.admin select.databases").prop("disabled",!1),a("section.admin .dbSelect").removeClass("disabled")},saveSettings:function(){this.account=a("#account_id").val(),a.cookie("account",this.account,{expires:365,path:"/"}),this.hideSettings(),this.loadAccount()},getAccounts:function(a){this.accounts=a.accounts.account,this.initAccounts()},loadAccount:function(){this.colManager&&(this.colManager.destroy(),delete this.colManager),this.colManager=new App.ColumnController(this.account),this.API.getData(this.account,"dates/range",{},a.proxy(this.getDateRange,this))},getDateRange:function(a){var b=new Date(a.dates.range.first.year,a.dates.range.first.month,a.dates.range.first.day,0,0,0,0),c=new Date(a.dates.range.last.year,a.dates.range.last.month,a.dates.range.last.day,0,0,0,0);this.dateSettings.minTime=b.getTime(),this.dateSettings.maxTime=c.getTime(),this.colManager.setDates(this.dateSettings),this.colManager.addColumn("contacts",{limit:20})},handleScroll:function(){},handleResize:function(){},destroy:function(){}},e}(jQuery,document,window,Utils),App.NavController=function(a,b,c,d,e){"use strict";function f(){console.log("NAV CONTROLLER INIT"),this.currentPage="",this.router=new e.Router,this.pageNotFound=!1,this.createRoutes(),this.pageController=this.loadController()}return f.prototype={createRoutes:function(){this.router.addRoutes([{path:"/",controller:"MinezyController"}])},loadController:function(){a("#404").length&&(this.pageNotFound=!0);var b={};if(this.pageNotFound||(b=this.router.route()),b)return b.createController();throw new Error("Undefined route: "+c.location.pathname)},destroy:function(){}},f}(jQuery,document,window,App,Utils),App.API=function(a){function b(){this.api_root="http://localhost:5000",this.api_version=1,this.current_call=null}return b.prototype={getData:function(b,c,d,e){this.current_call&&(this.current_call.abort(),delete this.current_call),this.current_call=a.ajax({type:"GET",url:this.constructURL(b,c,d),data:d,dataType:"json"}).done(a.proxy(function(a){e(a)},this))},constructURL:function(a,b){var c="";a&&(c=a+"/"),console.log(a,c,b);var d=this.api_root+"/"+this.api_version+"/"+c+b;return console.log(d),d},destroy:function(){}},b}(jQuery,document,window,Utils),App.ActionTree=function(){function a(){}var b={root:{contacts:{"contacts-left":{"dates-to":{"dates-day":{"emails-list":{"emails/meta":!1}},"emails-list":{"emails/meta":!1}},"emails-list":{"emails/meta":!1},"contacts-right":{"dates-to":{"dates-day":{"emails-list":{"emails/meta":!1}},"emails-list":{"emails/meta":!1}},"emails-list":{"emails/meta":!1}}},dates:{"dates-day":{"emails-list":{"emails/meta":!1},"contacts-left":{"emails-list":{"emails/meta":!1}}},"contacts-left":{"dates-day":{"emails-list":{"emails/meta":!1}},"emails-list":{"emails/meta":!1},"contacts-right":!1},"emails-list":{"emails/meta":!1}},"emails-list":{"emails/meta":!1}},dates:{contacts:{"contacts-left":{"dates-day":{"emails-list":{"emails/meta":!1}},"emails-list":{"emails/meta":!1},"contacts-right":{"dates-day":{"emails-list":{"emails/meta":!1}},"emails-list":{"emails/meta":!1}}},"dates-day":{"contacts-left":{"emails-list":{"emails/meta":!1},"contacts-right":!1},"emails-list":{"emails/meta":!1}},"emails-list":{"emails/meta":!1}},"dates-day":{contacts:{"contacts-left":{"emails-list":{"emails/meta":!1},"contacts-right":!1},"emails-list":{"emails/meta":!1}},"emails-list":{"emails/meta":!1}}}}};return a.prototype={getActions:function(a){var c=a.slice(0),d=this.traverse(b,c),e=[];for(var f in d)e.push(f);return c=null,e},traverse:function(a,b){var c;return 1==b.length?a[b.shift()]:(c=b.shift(),this.traverse(a[c],b))},destroy:function(){}},a}(jQuery,document,window,Utils),Utils.Route=function(){"use strict";function a(a,b){this.path=a,this.controller=b}return a.prototype={match:function(a){var b=new RegExp("^/?"+this.path+"/?$"),c=a.match(b);return null!==c?!0:!1},createController:function(a){if("undefined"!=typeof App[this.controller])return new App[this.controller](a);throw new Error("Controller cannot be created! ("+this.controller+")")}},a}(),Utils.Router=function(a,b){"use strict";function c(a){this.options=a||{},this.routes=[]}return c.prototype={addRoute:function(a,c){var d=new b.Route(a,c);this.routes.push(d)},addRoutes:function(b){a.each(b,a.proxy(function(a,b){this.addRoute(b.path,b.controller)},this))},getManualRoute:function(b){var c=!1;return a.each(this.routes,function(a,d){d.controller===b&&(c=d)}),c},route:function(){var b=!1;return a.each(this.routes,function(a,c){c.match(window.location.pathname)&&!b&&(b=c)}),b}},c}(jQuery,Utils);
//# sourceMappingURL=core.min.js.map